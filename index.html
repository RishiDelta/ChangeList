<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Change Dashboard</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:        #0d1117;
      --surface:   #161b22;
      --border:    #30363d;
      --text:      #e6edf3;
      --muted:     #8b949e;
      --prod:      #f85149;
      --prod-bg:   rgba(248, 81, 73, 0.12);
      --uat:       #58a6ff;
      --uat-bg:    rgba(88, 166, 255, 0.12);
      --accent:    #3fb950;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      min-height: 100vh;
      padding: 0 0 48px;
    }

    /* ── Header ─────────────────────────────────────────── */
    header {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 20px 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.15rem;
      font-weight: 700;
      letter-spacing: -0.3px;
    }

    .logo-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 8px var(--accent);
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; box-shadow: 0 0 8px var(--accent); }
      50%       { opacity: 0.6; box-shadow: 0 0 3px var(--accent); }
    }

    /* ── Clock block ─────────────────────────────────────── */
    .clock-block {
      display: flex;
      align-items: center;
      gap: 24px;
      flex-wrap: wrap;
    }

    .clock-item {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }

    .clock-label {
      font-size: 0.68rem;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: var(--muted);
      margin-bottom: 2px;
    }

    .clock-value {
      font-size: 1.1rem;
      font-weight: 600;
      font-variant-numeric: tabular-nums;
      color: var(--text);
    }

    .clock-value.session {
      color: var(--accent);
    }

    .divider-v {
      width: 1px;
      height: 36px;
      background: var(--border);
    }

    /* ── Main layout ─────────────────────────────────────── */
    main {
      max-width: 960px;
      margin: 0 auto;
      padding: 32px 24px 0;
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .section-title {
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: var(--muted);
    }

    .filter-row {
      display: flex;
      gap: 8px;
    }

    .filter-btn {
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 6px;
      color: var(--muted);
      cursor: pointer;
      font-size: 0.78rem;
      padding: 4px 10px;
      transition: all 0.15s;
    }

    .filter-btn:hover        { border-color: var(--text); color: var(--text); }
    .filter-btn.active       { background: var(--surface); color: var(--text); border-color: var(--text); }
    .filter-btn.active.prod  { border-color: var(--prod); color: var(--prod); background: var(--prod-bg); }
    .filter-btn.active.uat   { border-color: var(--uat);  color: var(--uat);  background: var(--uat-bg);  }

    /* ── Change cards ────────────────────────────────────── */
    .change-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 18px 22px;
      transition: border-color 0.15s, transform 0.15s;
    }

    .card:hover {
      border-color: #484f58;
      transform: translateY(-1px);
    }

    .card.prod { border-left: 3px solid var(--prod); }
    .card.uat  { border-left: 3px solid var(--uat);  }

    .card-top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }

    .card-meta {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .change-id {
      font-weight: 700;
      font-size: 0.95rem;
      letter-spacing: -0.2px;
    }

    .env-badge {
      font-size: 0.7rem;
      font-weight: 700;
      letter-spacing: 0.6px;
      text-transform: uppercase;
      padding: 2px 8px;
      border-radius: 20px;
    }

    .env-badge.prod { background: var(--prod-bg); color: var(--prod); }
    .env-badge.uat  { background: var(--uat-bg);  color: var(--uat);  }

    .service-tag {
      font-size: 0.78rem;
      color: var(--muted);
      background: rgba(255,255,255,0.04);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 1px 7px;
    }

    .card-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 4px;
      flex-shrink: 0;
    }

    .time-ago {
      font-size: 0.8rem;
      color: var(--muted);
      font-variant-numeric: tabular-nums;
    }

    .version {
      font-size: 0.75rem;
      color: #6e7681;
      font-family: "SFMono-Regular", Consolas, monospace;
    }

    .owner-row {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 10px;
    }

    .avatar {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      font-size: 0.65rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .avatar.shay   { background: #6e40c9; color: #fff; }
    .avatar.daniel { background: #0075ca; color: #fff; }

    .owner-name {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .description {
      font-size: 0.85rem;
      color: #adbac7;
      line-height: 1.55;
      border-top: 1px solid var(--border);
      padding-top: 10px;
    }

    /* ── Hidden state ────────────────────────────────────── */
    .card.hidden { display: none; }

    /* ── Empty state ────────────────────────────────────── */
    .empty-msg {
      text-align: center;
      padding: 48px 0;
      color: var(--muted);
      font-size: 0.9rem;
      display: none;
    }

    /* ── Stats bar ───────────────────────────────────────── */
    .stats-bar {
      display: flex;
      gap: 20px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }

    .stat {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 20px;
      display: flex;
      flex-direction: column;
      gap: 3px;
      flex: 1;
      min-width: 110px;
    }

    .stat-number {
      font-size: 1.6rem;
      font-weight: 700;
      font-variant-numeric: tabular-nums;
      line-height: 1;
    }

    .stat-label {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.7px;
      color: var(--muted);
    }

    .stat-number.all  { color: var(--text); }
    .stat-number.prod { color: var(--prod); }
    .stat-number.uat  { color: var(--uat);  }

    /* ── Responsive ──────────────────────────────────────── */
    @media (max-width: 600px) {
      header { padding: 16px 20px; }
      main   { padding: 24px 16px 0; }
      .clock-item { align-items: flex-start; }
    }
  </style>
</head>
<body>

<header>
  <div class="logo">
    <div class="logo-dot"></div>
    Change Dashboard
  </div>
  <div class="clock-block">
    <div class="clock-item">
      <span class="clock-label">Session opened at</span>
      <span class="clock-value session" id="session-time">—</span>
    </div>
    <div class="divider-v"></div>
    <div class="clock-item">
      <span class="clock-label">Local time now</span>
      <span class="clock-value" id="live-time">—</span>
    </div>
  </div>
</header>

<main>

  <div class="stats-bar">
    <div class="stat">
      <span class="stat-number all" id="count-all">6</span>
      <span class="stat-label">Total Changes</span>
    </div>
    <div class="stat">
      <span class="stat-number prod" id="count-prod">2</span>
      <span class="stat-label">Production</span>
    </div>
    <div class="stat">
      <span class="stat-number uat" id="count-uat">4</span>
      <span class="stat-label">UAT</span>
    </div>
  </div>

  <div class="section-header">
    <span class="section-title">Recent Changes</span>
    <div class="filter-row">
      <button class="filter-btn active" data-filter="all"  onclick="setFilter('all', this)">All</button>
      <button class="filter-btn prod"   data-filter="prod" onclick="setFilter('prod', this)">PROD</button>
      <button class="filter-btn uat"    data-filter="uat"  onclick="setFilter('uat', this)">UAT</button>
    </div>
  </div>

  <div class="change-list" id="change-list">

    <!-- CHG89357 — 1 hr ago — UAT -->
    <div class="card uat" data-env="uat">
      <div class="card-top">
        <div class="card-meta">
          <span class="change-id">CHG89357</span>
          <span class="env-badge uat">UAT</span>
          <span class="service-tag">Frontend Service</span>
        </div>
        <div class="card-right">
          <span class="time-ago">1 hour ago</span>
          <span class="version">v2.1.6</span>
        </div>
      </div>
      <div class="owner-row">
        <div class="avatar shay">SH</div>
        <span class="owner-name">Shay</span>
      </div>
      <p class="description">Testing mobile responsive layout improvements for product pages. Validates cross-browser compatibility before production release.</p>
    </div>

    <!-- CHG89355 — 2 hrs ago — UAT -->
    <div class="card uat" data-env="uat">
      <div class="card-top">
        <div class="card-meta">
          <span class="change-id">CHG89355</span>
          <span class="env-badge uat">UAT</span>
          <span class="service-tag">Ad Service</span>
        </div>
        <div class="card-right">
          <span class="time-ago">2 hours ago</span>
          <span class="version">v1.4.2</span>
        </div>
      </div>
      <div class="owner-row">
        <div class="avatar daniel">DA</div>
        <span class="owner-name">Daniel</span>
      </div>
      <p class="description">Testing new ad placement algorithm for homepage banner. Validates impression tracking and click-through rate measurements before production rollout.</p>
    </div>

    <!-- CHG89351 — 7 hrs ago — PROD -->
    <div class="card prod" data-env="prod">
      <div class="card-top">
        <div class="card-meta">
          <span class="change-id">CHG89351</span>
          <span class="env-badge prod">PROD</span>
          <span class="service-tag">Checkout Service</span>
        </div>
        <div class="card-right">
          <span class="time-ago">7 hours ago</span>
          <span class="version">v1.8.2</span>
        </div>
      </div>
      <div class="owner-row">
        <div class="avatar daniel">DA</div>
        <span class="owner-name">Daniel</span>
      </div>
      <p class="description">Promoted UAT changes to production. Enhanced payment validation logic and added a retry mechanism for transient payment gateway failures.</p>
    </div>

    <!-- CHG89348 — 8 hrs ago — UAT -->
    <div class="card uat" data-env="uat">
      <div class="card-top">
        <div class="card-meta">
          <span class="change-id">CHG89348</span>
          <span class="env-badge uat">UAT</span>
          <span class="service-tag">Checkout Service</span>
        </div>
        <div class="card-right">
          <span class="time-ago">8 hours ago</span>
          <span class="version">v1.8.2</span>
        </div>
      </div>
      <div class="owner-row">
        <div class="avatar daniel">DA</div>
        <span class="owner-name">Daniel</span>
      </div>
      <p class="description">Final UAT testing of enhanced payment validation logic. Includes retry mechanism for payment gateway timeouts and improved error messaging.</p>
    </div>

    <!-- CHG89342 — 22 hrs ago — PROD -->
    <div class="card prod" data-env="prod">
      <div class="card-top">
        <div class="card-meta">
          <span class="change-id">CHG89342</span>
          <span class="env-badge prod">PROD</span>
          <span class="service-tag">Cart Service</span>
        </div>
        <div class="card-right">
          <span class="time-ago">22 hours ago</span>
          <span class="version">v1.2.3</span>
        </div>
      </div>
      <div class="owner-row">
        <div class="avatar shay">SH</div>
        <span class="owner-name">Shay</span>
      </div>
      <p class="description">Promoted UAT changes to production. Added business metric logging for cart operations and improved session handling for better performance tracking.</p>
    </div>

    <!-- CHG89340 — 24 hrs ago — UAT -->
    <div class="card uat" data-env="uat">
      <div class="card-top">
        <div class="card-meta">
          <span class="change-id">CHG89340</span>
          <span class="env-badge uat">UAT</span>
          <span class="service-tag">Cart Service</span>
        </div>
        <div class="card-right">
          <span class="time-ago">24 hours ago</span>
          <span class="version">v1.2.3</span>
        </div>
      </div>
      <div class="owner-row">
        <div class="avatar shay">SH</div>
        <span class="owner-name">Shay</span>
      </div>
      <p class="description">Testing business metric logging for cart add/remove operations. Preparing for production deployment after successful UAT validation.</p>
    </div>

  </div><!-- /.change-list -->

  <p class="empty-msg" id="empty-msg">No changes for this filter.</p>

</main>

<script>
  // ── Session-persistent clock ───────────────────────────────────────────────
  // Uses sessionStorage so the captured time survives tab refreshes
  // but resets when the tab is closed and a new one is opened.

  const SESSION_KEY = 'changeDashboard_sessionOpenedAt';

  function pad(n) { return String(n).padStart(2, '0'); }

  function formatTime(date) {
    return `${pad(date.getHours())}:${pad(date.getMinutes())}:${pad(date.getSeconds())}`;
  }

  function formatDate(date) {
    const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
    const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    return `${days[date.getDay()]} ${date.getDate()} ${months[date.getMonth()]}`;
  }

  // Capture or restore session open time
  let sessionOpenedAt;
  const stored = sessionStorage.getItem(SESSION_KEY);

  if (stored) {
    sessionOpenedAt = new Date(parseInt(stored, 10));
  } else {
    sessionOpenedAt = new Date();
    sessionStorage.setItem(SESSION_KEY, sessionOpenedAt.getTime().toString());
  }

  const sessionEl = document.getElementById('session-time');
  const liveEl    = document.getElementById('live-time');

  sessionEl.textContent = `${formatDate(sessionOpenedAt)}, ${formatTime(sessionOpenedAt)}`;

  // Live clock — updates every second
  function tickLive() {
    const now = new Date();
    liveEl.textContent = `${formatDate(now)}, ${formatTime(now)}`;
  }
  tickLive();
  setInterval(tickLive, 1000);

  // ── Filter logic ──────────────────────────────────────────────────────────
  let activeFilter = 'all';

  function setFilter(filter, btn) {
    activeFilter = filter;

    document.querySelectorAll('.filter-btn').forEach(b => {
      b.classList.remove('active');
    });
    btn.classList.add('active');

    const cards = document.querySelectorAll('.card');
    let visible = 0;

    cards.forEach(card => {
      const env = card.dataset.env;
      const show = filter === 'all' || env === filter;
      card.classList.toggle('hidden', !show);
      if (show) visible++;
    });

    document.getElementById('empty-msg').style.display = visible === 0 ? 'block' : 'none';
  }
</script>

</body>
</html>
